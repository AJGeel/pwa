<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>Pomodoro App &mdash; Prototype</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css" />
    <link rel="stylesheet" type="text/css" href="css/pomo.css" />
    <link rel="shortcut icon" href="https://arthurgeel.com/experiments/img/favicon.png" />

  </head>
  <body>

    <div class="wrapper">

      <p class="timer">
        <span id="minutes">25</span>:<span id="seconds">00</span>
      </p>

      <ul>
        <li><a href="#!" id="startStopBtn">Start</a></li>
        <li><a href="#!" id="resetBtn">Reset</a></li>
      </ul>

      <ul class="studyMinutes">
        <li><a href="#!" id="study20">05</a></li>
        <li><a href="#!" class="active" id="study25">25</a></li>
        <li><a href="#!" id="study30">ðŸ’£</a></li>
      </ul>

    </div>

  </body>

  <script>

    var timeLeft = 1500;
    var timerId = setInterval(countdown, 1000);
    var countdownActive = false;
    var gongPlaying = false;

    function countdown() {
      if (timeLeft == 0) {
        var gongPlaying = false;
        document.getElementById("startStopBtn").classList.remove("active");
        document.getElementById("resetBtn").classList.toggle("active");
        /* Todo:                                               /
        /  Log one successful session of $MINUTES to back-end */
      } else {
        if (timeLeft == 1){
          if (!gongPlaying){
            var gong = new Audio('gong.mp3'); // Play the gong sound effect
            gong.play();
            gongPlaying = true; // Reset the gongPlaying variable to prevent audio stacking
          }
        }

        if (countdownActive){   // Remove one second, every second
          timeLeft--;
        };
      }

      formatSeconds(timeLeft);
    }

    document.getElementById("startStopBtn").addEventListener("click", startStopFunction);
    document.getElementById("resetBtn").addEventListener("click", resetFunction);
    document.getElementById("study20").addEventListener("click", changeTo20);
    document.getElementById("study25").addEventListener("click", changeTo25);
    document.getElementById("study30").addEventListener("click", changeTo30);

    function startStopFunction(){
      countdownActive = !countdownActive;
      if (countdownActive){
        document.getElementById("startStopBtn").innerHTML = "Pause";
        document.getElementById("startStopBtn").classList.toggle("active");
      } else {
        document.getElementById("startStopBtn").innerHTML = "Start";
        document.getElementById("startStopBtn").classList.toggle("active");
      }
    }

    function resetFunction(){
      timeLeft = 1500;

      if(countdownActive){
        countdownActive = !countdownActive;
        document.getElementById("startStopBtn").innerHTML = "Start";
        document.getElementById("startStopBtn").classList.remove("active");
      }

      if(document.getElementById("study25").classList.contains("active")){
        // do nothing
      } else {
        document.getElementById("study25").classList.toggle("active");
        document.getElementById("study20").classList.remove("active");
        document.getElementById("study30").classList.remove("active");
      }
    }

    function changeTo20(){
      timeLeft = 300;

      if(document.getElementById("study20").classList.contains("active")){
        // do nothing
      } else {
        document.getElementById("study20").classList.toggle("active");
        document.getElementById("study25").classList.remove("active");
        document.getElementById("study30").classList.remove("active");

        if(!countdownActive){
          countdownActive = !countdownActive;
          document.getElementById("startStopBtn").innerHTML = "Pause";
          document.getElementById("startStopBtn").classList.toggle("active");
        }
      }
    }

    function changeTo25(){
      timeLeft = 1500;

      if(document.getElementById("study25").classList.contains("active")){
        // do nothing
      } else {
        document.getElementById("study25").classList.toggle("active");
        document.getElementById("study20").classList.remove("active");
        document.getElementById("study30").classList.remove("active");

        if(!countdownActive){
          countdownActive = !countdownActive;
          document.getElementById("startStopBtn").innerHTML = "Pause";
          document.getElementById("startStopBtn").classList.toggle("active");
        }
      }
    }

    function changeTo30(){
      timeLeft = 6;

      if(document.getElementById("study30").classList.contains("active")){
        // do nothing
      } else {
        document.getElementById("study30").classList.toggle("active");
        document.getElementById("study20").classList.remove("active");
        document.getElementById("study25").classList.remove("active");

        if(!countdownActive){
          countdownActive = !countdownActive;
          document.getElementById("startStopBtn").innerHTML = "Pause";
          document.getElementById("startStopBtn").classList.toggle("active");
        }
      }
    }


    // document.addEventListener("keypress", function(event) {
    //
    //     if (event.keyCode == 97) {
    //       countdownActive = !countdownActive;
    //     }
    // });


    function formatSeconds(input) {
      input = Number(input);
      var m = Math.floor(input % 3600 / 60);   // changes seconds to minutes
      var s = Math.floor(input % 3600 % 60);   // shows the remainder seconds

      var formattedM = ("0" + m).slice(-2);    // upkeeps the "00" format
      var formattedS = ("0" + s).slice(-2);    // upkeeps the "00" format

      document.getElementById('minutes').innerHTML = formattedM;
      document.getElementById('seconds').innerHTML = formattedS;
    }

  </script>


<script>function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-84000548-1","auto"),ga("send","pageview");
</script>
</html>
